<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Repetier-Firmware: Repetier/SdFat.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="repetier-logo64.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Repetier-Firmware&#160;<span id="projectnumber">0.2</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_sd_fat_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Repetier/SdFat.h</div>  </div>
</div>
<div class="contents">
<a href="_sd_fat_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Arduino SdFat Library</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (C) 2009 by William Greiman</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This file is part of the Arduino SdFat Library</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This Library is free software: you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00008"></a>00008 <span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00009"></a>00009 <span class="comment"> * (at your option) any later version.</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> * This Library is distributed in the hope that it will be useful,</span>
<a name="l00012"></a>00012 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00013"></a>00013 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00014"></a>00014 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * along with the Arduino SdFat Library.  If not, see</span>
<a name="l00018"></a>00018 <span class="comment"> * &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00019"></a>00019 <span class="comment"> */</span>
<a name="l00020"></a>00020 <span class="preprocessor">#ifndef SdFat_h</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#define SdFat_h</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;avr/pgmspace.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="_sd2_card_8h.html">Sd2Card.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="_fat_structs_8h.html">FatStructs.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;Print.h&quot;</span>
<a name="l00030"></a>00030 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00034"></a><a class="code" href="_sd_fat_8h.html#af8ef36dfd023f41169baa17d05f55c56">00034</a> <span class="comment"></span><span class="preprocessor">#define ALLOW_DEPRECATED_FUNCTIONS 1</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00036"></a>00036 <span class="comment">// forward declaration since SdVolume is used in SdFile</span>
<a name="l00037"></a>00037 <span class="keyword">class </span><a class="code" href="class_sd_volume.html" title="Access FAT16 and FAT32 volumes on SD and SDHC cards.">SdVolume</a>;
<a name="l00038"></a>00038 <span class="comment">//==============================================================================</span>
<a name="l00039"></a>00039 <span class="comment">// SdFile class</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="comment">// flags for ls()</span>
<a name="l00043"></a><a class="code" href="_sd_fat_8h.html#ac78cfe032599ef1f5723c62106017fcd">00043</a> <span class="comment"></span>uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#ac78cfe032599ef1f5723c62106017fcd">LS_DATE</a> = 1;
<a name="l00045"></a><a class="code" href="_sd_fat_8h.html#a8170e56f2df0139f3acd73c35636fa7f">00045</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a8170e56f2df0139f3acd73c35636fa7f">LS_SIZE</a> = 2;
<a name="l00047"></a><a class="code" href="_sd_fat_8h.html#af90ecd4124f4c2563b37174be91e76f9">00047</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#af90ecd4124f4c2563b37174be91e76f9">LS_R</a> = 4;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">// use the gnu style oflag in open()</span>
<a name="l00051"></a><a class="code" href="_sd_fat_8h.html#ac5a1c3e543273b0374ba114c496e662e">00051</a> <span class="comment"></span>uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#ac5a1c3e543273b0374ba114c496e662e">O_READ</a> = 0X01;
<a name="l00053"></a><a class="code" href="_sd_fat_8h.html#ac13ca62d7e6f8f6d657d4607474652bf">00053</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#ac13ca62d7e6f8f6d657d4607474652bf">O_RDONLY</a> = <a class="code" href="_sd_fat_8h.html#ac5a1c3e543273b0374ba114c496e662e">O_READ</a>;
<a name="l00055"></a><a class="code" href="_sd_fat_8h.html#a44c1620ada13f6318ab39b9fa38ef55a">00055</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a44c1620ada13f6318ab39b9fa38ef55a">O_WRITE</a> = 0X02;
<a name="l00057"></a><a class="code" href="_sd_fat_8h.html#a782767ee2580bb1566048017b254281d">00057</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a782767ee2580bb1566048017b254281d">O_WRONLY</a> = <a class="code" href="_sd_fat_8h.html#a44c1620ada13f6318ab39b9fa38ef55a">O_WRITE</a>;
<a name="l00059"></a><a class="code" href="_sd_fat_8h.html#ad79c5a45cb5e4855b771629fc15d78f6">00059</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#ad79c5a45cb5e4855b771629fc15d78f6">O_RDWR</a> = (<a class="code" href="_sd_fat_8h.html#ac5a1c3e543273b0374ba114c496e662e">O_READ</a> | <a class="code" href="_sd_fat_8h.html#a44c1620ada13f6318ab39b9fa38ef55a">O_WRITE</a>);
<a name="l00061"></a><a class="code" href="_sd_fat_8h.html#a4efda39151f5ef2dc7fbd138be51336a">00061</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a4efda39151f5ef2dc7fbd138be51336a">O_ACCMODE</a> = (<a class="code" href="_sd_fat_8h.html#ac5a1c3e543273b0374ba114c496e662e">O_READ</a> | <a class="code" href="_sd_fat_8h.html#a44c1620ada13f6318ab39b9fa38ef55a">O_WRITE</a>);
<a name="l00063"></a><a class="code" href="_sd_fat_8h.html#a4242b37e810af3a6485adda0e08a9a2b">00063</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a4242b37e810af3a6485adda0e08a9a2b">O_APPEND</a> = 0X04;
<a name="l00065"></a><a class="code" href="_sd_fat_8h.html#a3066c471d52b056dec13fa567f7bbd9d">00065</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a3066c471d52b056dec13fa567f7bbd9d">O_SYNC</a> = 0X08;
<a name="l00067"></a><a class="code" href="_sd_fat_8h.html#a20d0ef801486dd02de6ee482de731193">00067</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a20d0ef801486dd02de6ee482de731193">O_CREAT</a> = 0X10;
<a name="l00069"></a><a class="code" href="_sd_fat_8h.html#ab5635d4288cb294c1ed000fa183e072b">00069</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#ab5635d4288cb294c1ed000fa183e072b">O_EXCL</a> = 0X20;
<a name="l00071"></a><a class="code" href="_sd_fat_8h.html#a9dc438ff90d0c8af452331c339dbc08e">00071</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a9dc438ff90d0c8af452331c339dbc08e">O_TRUNC</a> = 0X40;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">// flags for timestamp</span>
<a name="l00075"></a><a class="code" href="_sd_fat_8h.html#a5f34ce6e95713d872ca6a640c8783462">00075</a> <span class="comment"></span>uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a5f34ce6e95713d872ca6a640c8783462">T_ACCESS</a> = 1;
<a name="l00077"></a><a class="code" href="_sd_fat_8h.html#a533dc316f5a59209ac5e9c630d2df4c4">00077</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a533dc316f5a59209ac5e9c630d2df4c4">T_CREATE</a> = 2;
<a name="l00079"></a><a class="code" href="_sd_fat_8h.html#a2a6192fd0f5847783868deed6de53d1e">00079</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a2a6192fd0f5847783868deed6de53d1e">T_WRITE</a> = 4;
<a name="l00080"></a>00080 <span class="comment">// values for type_</span>
<a name="l00082"></a><a class="code" href="_sd_fat_8h.html#a4da8c96e256b06356321e81705494010">00082</a> <span class="comment"></span>uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a4da8c96e256b06356321e81705494010">FAT_FILE_TYPE_CLOSED</a> = 0;
<a name="l00084"></a><a class="code" href="_sd_fat_8h.html#a666774999b9afd627fdad75471101581">00084</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a666774999b9afd627fdad75471101581">FAT_FILE_TYPE_NORMAL</a> = 1;
<a name="l00086"></a><a class="code" href="_sd_fat_8h.html#a4c02ced3c57420e2a1997f51bd87d150">00086</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a4c02ced3c57420e2a1997f51bd87d150">FAT_FILE_TYPE_ROOT16</a> = 2;
<a name="l00088"></a><a class="code" href="_sd_fat_8h.html#a9a1a07cb1d09cfdb3cc53183c6e5dc57">00088</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a9a1a07cb1d09cfdb3cc53183c6e5dc57">FAT_FILE_TYPE_ROOT32</a> = 3;
<a name="l00090"></a><a class="code" href="_sd_fat_8h.html#ac301b0465fdd7953c6e110b9896cc9fd">00090</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#ac301b0465fdd7953c6e110b9896cc9fd">FAT_FILE_TYPE_SUBDIR</a> = 4;
<a name="l00092"></a><a class="code" href="_sd_fat_8h.html#abc9b0906aeeedfe122b0ca629bac889b">00092</a> uint8_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#abc9b0906aeeedfe122b0ca629bac889b">FAT_FILE_TYPE_MIN_DIR</a> = <a class="code" href="_sd_fat_8h.html#a4c02ced3c57420e2a1997f51bd87d150">FAT_FILE_TYPE_ROOT16</a>;
<a name="l00093"></a>00093 
<a name="l00095"></a><a class="code" href="_sd_fat_8h.html#a44899ad42ddf32ff1c1a73b5251b304a">00095</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint16_t <a class="code" href="_sd_fat_8h.html#a44899ad42ddf32ff1c1a73b5251b304a">FAT_DATE</a>(uint16_t year, uint8_t month, uint8_t day) {
<a name="l00096"></a>00096   <span class="keywordflow">return</span> (year - 1980) &lt;&lt; 9 | month &lt;&lt; 5 | day;
<a name="l00097"></a>00097 }
<a name="l00099"></a><a class="code" href="_sd_fat_8h.html#a279a75f907dd2603543c7bdad00ff603">00099</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint16_t <a class="code" href="_sd_fat_8h.html#a279a75f907dd2603543c7bdad00ff603">FAT_YEAR</a>(uint16_t fatDate) {
<a name="l00100"></a>00100   <span class="keywordflow">return</span> 1980 + (fatDate &gt;&gt; 9);
<a name="l00101"></a>00101 }
<a name="l00103"></a><a class="code" href="_sd_fat_8h.html#a429bc2d96f5bc26dc3bd6cc2bd535b84">00103</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint8_t <a class="code" href="_sd_fat_8h.html#a429bc2d96f5bc26dc3bd6cc2bd535b84">FAT_MONTH</a>(uint16_t fatDate) {
<a name="l00104"></a>00104   <span class="keywordflow">return</span> (fatDate &gt;&gt; 5) &amp; 0XF;
<a name="l00105"></a>00105 }
<a name="l00107"></a><a class="code" href="_sd_fat_8h.html#a4cc8bc105529bf9e9c11e8ef099d68b0">00107</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint8_t <a class="code" href="_sd_fat_8h.html#a4cc8bc105529bf9e9c11e8ef099d68b0">FAT_DAY</a>(uint16_t fatDate) {
<a name="l00108"></a>00108   <span class="keywordflow">return</span> fatDate &amp; 0X1F;
<a name="l00109"></a>00109 }
<a name="l00111"></a><a class="code" href="_sd_fat_8h.html#a375720927be5a39475d48b2d75dae29a">00111</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint16_t <a class="code" href="_sd_fat_8h.html#a375720927be5a39475d48b2d75dae29a">FAT_TIME</a>(uint8_t hour, uint8_t minute, uint8_t second) {
<a name="l00112"></a>00112   <span class="keywordflow">return</span> hour &lt;&lt; 11 | minute &lt;&lt; 5 | second &gt;&gt; 1;
<a name="l00113"></a>00113 }
<a name="l00115"></a><a class="code" href="_sd_fat_8h.html#ae7c733d49a5570054f6db3bd53332ba1">00115</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint8_t <a class="code" href="_sd_fat_8h.html#ae7c733d49a5570054f6db3bd53332ba1">FAT_HOUR</a>(uint16_t fatTime) {
<a name="l00116"></a>00116   <span class="keywordflow">return</span> fatTime &gt;&gt; 11;
<a name="l00117"></a>00117 }
<a name="l00119"></a><a class="code" href="_sd_fat_8h.html#a1b09676a41ae6c9e19664bdcd5b1d34e">00119</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint8_t <a class="code" href="_sd_fat_8h.html#a1b09676a41ae6c9e19664bdcd5b1d34e">FAT_MINUTE</a>(uint16_t fatTime) {
<a name="l00120"></a>00120   <span class="keywordflow">return</span>(fatTime &gt;&gt; 5) &amp; 0X3F;
<a name="l00121"></a>00121 }
<a name="l00123"></a><a class="code" href="_sd_fat_8h.html#a4d553e2088d42e01d6c08ee84e611b00">00123</a> <span class="keyword">static</span> <span class="keyword">inline</span> uint8_t <a class="code" href="_sd_fat_8h.html#a4d553e2088d42e01d6c08ee84e611b00">FAT_SECOND</a>(uint16_t fatTime) {
<a name="l00124"></a>00124   <span class="keywordflow">return</span> 2*(fatTime &amp; 0X1F);
<a name="l00125"></a>00125 }
<a name="l00127"></a><a class="code" href="_sd_fat_8h.html#a441bb1bc5f52d512656de3b86a279948">00127</a> uint16_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a441bb1bc5f52d512656de3b86a279948">FAT_DEFAULT_DATE</a> = ((2000 - 1980) &lt;&lt; 9) | (1 &lt;&lt; 5) | 1;
<a name="l00129"></a><a class="code" href="_sd_fat_8h.html#a00451fc2d3563a2255797bd1f40507fb">00129</a> uint16_t <span class="keyword">const</span> <a class="code" href="_sd_fat_8h.html#a00451fc2d3563a2255797bd1f40507fb">FAT_DEFAULT_TIME</a> = (1 &lt;&lt; 11);
<a name="l00130"></a>00130 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00135"></a><a class="code" href="class_sd_file.html">00135</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a> : <span class="keyword">public</span> Print {
<a name="l00136"></a>00136  <span class="keyword">public</span>:
<a name="l00138"></a><a class="code" href="class_sd_file.html#a1cdaafced3b9430cf8dbbda1e1b5cbfa">00138</a>   <a class="code" href="class_sd_file.html#a1cdaafced3b9430cf8dbbda1e1b5cbfa">SdFile</a>(<span class="keywordtype">void</span>) : <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a>(<a class="code" href="_sd_fat_8h.html#a4da8c96e256b06356321e81705494010">FAT_FILE_TYPE_CLOSED</a>) {}
<a name="l00144"></a><a class="code" href="class_sd_file.html#a800e5043596b8bec0dd32076d3c9750c">00144</a>   <span class="keywordtype">bool</span> <a class="code" href="class_sd_file.html#a800e5043596b8bec0dd32076d3c9750c">writeError</a>;
<a name="l00149"></a><a class="code" href="class_sd_file.html#a7f24c32651c7e2481e235d80f4ebd1f7">00149</a>   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a7f24c32651c7e2481e235d80f4ebd1f7">clearUnbufferedRead</a>(<span class="keywordtype">void</span>) {
<a name="l00150"></a>00150     <a class="code" href="class_sd_file.html#ab9bc8d18308217bd7df78a01eca175b3">flags_</a> &amp;= ~<a class="code" href="class_sd_file.html#a48c45248ecab9849f87cf194dc46f5b3">F_FILE_UNBUFFERED_READ</a>;
<a name="l00151"></a>00151   }
<a name="l00152"></a>00152   uint8_t <a class="code" href="class_sd_file.html#acc7232df95dc547dff5d242fbcb26f73">close</a>(<span class="keywordtype">void</span>);
<a name="l00153"></a>00153   uint8_t <a class="code" href="class_sd_file.html#a58cdd235bc6f1b39342d902a35a2a172">contiguousRange</a>(uint32_t* bgnBlock, uint32_t* endBlock);
<a name="l00154"></a>00154   uint8_t <a class="code" href="class_sd_file.html#ab316b89ecd24d3d03781832e094fa9d1">createContiguous</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>* dirFile,
<a name="l00155"></a>00155           <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName, uint32_t size);
<a name="l00157"></a><a class="code" href="class_sd_file.html#ab287e557593ad32f46b92ec5b11c5e0f">00157</a>   uint32_t <a class="code" href="class_sd_file.html#ab287e557593ad32f46b92ec5b11c5e0f">curCluster</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#aff23051fbe8e6ad2efa75c06390047d5">curCluster_</a>;}
<a name="l00159"></a><a class="code" href="class_sd_file.html#ac8d7d68d019839dbb3d37f9ef840760f">00159</a>   uint32_t <a class="code" href="class_sd_file.html#ac8d7d68d019839dbb3d37f9ef840760f">curPosition</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ade9334005143268ed5c81348abbffb4b">curPosition_</a>;}
<a name="l00188"></a><a class="code" href="class_sd_file.html#ae89cdf7331e346cc8b7ce4a935c5b3e5">00188</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#ae89cdf7331e346cc8b7ce4a935c5b3e5">dateTimeCallback</a>(
<a name="l00189"></a>00189     <span class="keywordtype">void</span> (*dateTime)(uint16_t* date, uint16_t* time)) {
<a name="l00190"></a>00190     <a class="code" href="class_sd_file.html#a0fbdf53a669c68035108f7e71804ebc2">dateTime_</a> = dateTime;
<a name="l00191"></a>00191   }
<a name="l00195"></a><a class="code" href="class_sd_file.html#ab066a69714f6acd390595ebdc9a24066">00195</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#ab066a69714f6acd390595ebdc9a24066">dateTimeCallbackCancel</a>(<span class="keywordtype">void</span>) {
<a name="l00196"></a>00196     <span class="comment">// use explicit zero since NULL is not defined for Sanguino</span>
<a name="l00197"></a>00197     <a class="code" href="class_sd_file.html#a0fbdf53a669c68035108f7e71804ebc2">dateTime_</a> = 0;
<a name="l00198"></a>00198   }
<a name="l00200"></a><a class="code" href="class_sd_file.html#a0b1af2834fd9f5e318d2c9a19676da9c">00200</a>   uint32_t <a class="code" href="class_sd_file.html#a0b1af2834fd9f5e318d2c9a19676da9c">dirBlock</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a99b330c30b74c2cf030c279593a4c1dc">dirBlock_</a>;}
<a name="l00201"></a>00201   uint8_t <a class="code" href="class_sd_file.html#aeb45d4e6fa3c4631c1c4fe58ae321343">dirEntry</a>(<a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>* dir);
<a name="l00203"></a><a class="code" href="class_sd_file.html#a48840254cbb17536e5b49512e7154336">00203</a>   uint8_t <a class="code" href="class_sd_file.html#a48840254cbb17536e5b49512e7154336">dirIndex</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#adf65af6edbe7a86d1e94c7604c66ea51">dirIndex_</a>;}
<a name="l00204"></a>00204   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a3d5d6e21ff652084fa88f8f7d902c5b5">dirName</a>(<span class="keyword">const</span> <a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>&amp; dir, <span class="keywordtype">char</span>* name);
<a name="l00206"></a><a class="code" href="class_sd_file.html#a4e3a52830ecc17965098d3611102f5b8">00206</a>   uint32_t <a class="code" href="class_sd_file.html#a4e3a52830ecc17965098d3611102f5b8">fileSize</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a95d9791fe91d8b1385fc1f11b1dccb83">fileSize_</a>;}
<a name="l00208"></a><a class="code" href="class_sd_file.html#a270234ea80cdf33edf4c12f594eccc6d">00208</a>   uint32_t <a class="code" href="class_sd_file.html#a270234ea80cdf33edf4c12f594eccc6d">firstCluster</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a3ef82733a6bdd87b2f4a3128d2ad510d">firstCluster_</a>;}
<a name="l00210"></a><a class="code" href="class_sd_file.html#a8bb107a8597bf56cb4758ea93c1339c3">00210</a>   uint8_t <a class="code" href="class_sd_file.html#a8bb107a8597bf56cb4758ea93c1339c3">isDir</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a> &gt;= <a class="code" href="_sd_fat_8h.html#abc9b0906aeeedfe122b0ca629bac889b">FAT_FILE_TYPE_MIN_DIR</a>;}
<a name="l00212"></a><a class="code" href="class_sd_file.html#ac30c27abbb0813a4bf8ab05fb8b4d102">00212</a>   uint8_t <a class="code" href="class_sd_file.html#ac30c27abbb0813a4bf8ab05fb8b4d102">isFile</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a> == <a class="code" href="_sd_fat_8h.html#a666774999b9afd627fdad75471101581">FAT_FILE_TYPE_NORMAL</a>;}
<a name="l00214"></a><a class="code" href="class_sd_file.html#a82e3e75729324a104fc4e5bf86dadefb">00214</a>   uint8_t <a class="code" href="class_sd_file.html#a82e3e75729324a104fc4e5bf86dadefb">isOpen</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a> != <a class="code" href="_sd_fat_8h.html#a4da8c96e256b06356321e81705494010">FAT_FILE_TYPE_CLOSED</a>;}
<a name="l00216"></a><a class="code" href="class_sd_file.html#a428d4cea10433224edcebe8a923650d6">00216</a>   uint8_t <a class="code" href="class_sd_file.html#a428d4cea10433224edcebe8a923650d6">isSubDir</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a> == <a class="code" href="_sd_fat_8h.html#ac301b0465fdd7953c6e110b9896cc9fd">FAT_FILE_TYPE_SUBDIR</a>;}
<a name="l00218"></a><a class="code" href="class_sd_file.html#a93012b25d275f314d619d7d3f8a97660">00218</a>   uint8_t <a class="code" href="class_sd_file.html#a93012b25d275f314d619d7d3f8a97660">isRoot</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{
<a name="l00219"></a>00219     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a> == <a class="code" href="_sd_fat_8h.html#a4c02ced3c57420e2a1997f51bd87d150">FAT_FILE_TYPE_ROOT16</a> || <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a> == <a class="code" href="_sd_fat_8h.html#a9a1a07cb1d09cfdb3cc53183c6e5dc57">FAT_FILE_TYPE_ROOT32</a>;
<a name="l00220"></a>00220   }
<a name="l00221"></a>00221   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a3b2b7caeb6c55be39ac4aceee4718f1d">ls</a>(uint8_t flags = 0, uint8_t indent = 0);
<a name="l00222"></a>00222   uint8_t <a class="code" href="class_sd_file.html#ab0d36ef1545b565dd07d006a6a1d81fe">makeDir</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>* dir, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_sd_file.html#a3d5d6e21ff652084fa88f8f7d902c5b5">dirName</a>);
<a name="l00223"></a>00223   uint8_t <a class="code" href="class_sd_file.html#acf3fbda027da11e3a1ee1ac8505a1a62">open</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>* dirFile, uint16_t index, uint8_t oflag);
<a name="l00224"></a>00224   uint8_t <a class="code" href="class_sd_file.html#acf3fbda027da11e3a1ee1ac8505a1a62">open</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>* dirFile, <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName, uint8_t oflag);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   uint8_t <a class="code" href="class_sd_file.html#a3029872559d5d062bd474d8256a39208">openRoot</a>(<a class="code" href="class_sd_volume.html" title="Access FAT16 and FAT32 volumes on SD and SDHC cards.">SdVolume</a>* vol);
<a name="l00227"></a>00227   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a1b10b879b4871d9460e0b336efefd908">printDirName</a>(<span class="keyword">const</span> <a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>&amp; dir, uint8_t width);
<a name="l00228"></a>00228   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a56d33961896e2a571012c6f64f69f86e">printFatDate</a>(uint16_t fatDate);
<a name="l00229"></a>00229   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a93fd2d0e3e1a51127dd59815c3ad92a3">printFatTime</a>(uint16_t fatTime);
<a name="l00230"></a>00230   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#ad2498f5ea88280e7209e2dba0eb8e60e">printTwoDigits</a>(uint8_t v);
<a name="l00237"></a><a class="code" href="class_sd_file.html#a68a48d3cd8267e6b81107920591ec5c1">00237</a>   int16_t <a class="code" href="class_sd_file.html#a68a48d3cd8267e6b81107920591ec5c1">read</a>(<span class="keywordtype">void</span>) {
<a name="l00238"></a>00238     uint8_t b;
<a name="l00239"></a>00239     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a68a48d3cd8267e6b81107920591ec5c1">read</a>(&amp;b, 1) == 1 ? b : -1;
<a name="l00240"></a>00240   }
<a name="l00241"></a>00241   int16_t <a class="code" href="class_sd_file.html#a68a48d3cd8267e6b81107920591ec5c1">read</a>(<span class="keywordtype">void</span>* buf, uint16_t nbyte);
<a name="l00242"></a>00242   int8_t <a class="code" href="class_sd_file.html#addfe59dc0e7a6a8a88e9b7ecf5b51860">readDir</a>(<a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>* dir);
<a name="l00243"></a>00243   <span class="keyword">static</span> uint8_t <span class="keyword">remove</span>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>* dirFile, <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName);
<a name="l00244"></a>00244   uint8_t <span class="keyword">remove</span>(void);
<a name="l00246"></a><a class="code" href="class_sd_file.html#a826e5e3798ff6303db3afefbb6876f9a">00246</a>   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a826e5e3798ff6303db3afefbb6876f9a">rewind</a>(<span class="keywordtype">void</span>) {
<a name="l00247"></a>00247     <a class="code" href="class_sd_file.html#ade9334005143268ed5c81348abbffb4b">curPosition_</a> = <a class="code" href="class_sd_file.html#aff23051fbe8e6ad2efa75c06390047d5">curCluster_</a> = 0;
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249   uint8_t <a class="code" href="class_sd_file.html#a25e64fc365c9ee5709b2f4bdf5c09355">rmDir</a>(<span class="keywordtype">void</span>);
<a name="l00250"></a>00250   uint8_t <a class="code" href="class_sd_file.html#a373fdaec977d90508b9a697ae2c21fcd">rmRfStar</a>(<span class="keywordtype">void</span>);
<a name="l00252"></a><a class="code" href="class_sd_file.html#acfa82fa756a3429afc774697d9bc9a7c">00252</a>   uint8_t <a class="code" href="class_sd_file.html#acfa82fa756a3429afc774697d9bc9a7c">seekCur</a>(uint32_t pos) {
<a name="l00253"></a>00253     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#acd72057355577233a8e04aa92f1b73f4">seekSet</a>(<a class="code" href="class_sd_file.html#ade9334005143268ed5c81348abbffb4b">curPosition_</a> + pos);
<a name="l00254"></a>00254   }
<a name="l00259"></a><a class="code" href="class_sd_file.html#ac8647b82c102186603c3c790a6507122">00259</a>   uint8_t <a class="code" href="class_sd_file.html#ac8647b82c102186603c3c790a6507122">seekEnd</a>(<span class="keywordtype">void</span>) {<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#acd72057355577233a8e04aa92f1b73f4">seekSet</a>(<a class="code" href="class_sd_file.html#a95d9791fe91d8b1385fc1f11b1dccb83">fileSize_</a>);}
<a name="l00260"></a>00260   uint8_t <a class="code" href="class_sd_file.html#acd72057355577233a8e04aa92f1b73f4">seekSet</a>(uint32_t pos);
<a name="l00267"></a><a class="code" href="class_sd_file.html#ab45b2ff3592f732d3546d85ddd9b9f1f">00267</a>   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#ab45b2ff3592f732d3546d85ddd9b9f1f">setUnbufferedRead</a>(<span class="keywordtype">void</span>) {
<a name="l00268"></a>00268     <span class="keywordflow">if</span> (<a class="code" href="class_sd_file.html#ac30c27abbb0813a4bf8ab05fb8b4d102">isFile</a>()) <a class="code" href="class_sd_file.html#ab9bc8d18308217bd7df78a01eca175b3">flags_</a> |= <a class="code" href="class_sd_file.html#a48c45248ecab9849f87cf194dc46f5b3">F_FILE_UNBUFFERED_READ</a>;
<a name="l00269"></a>00269   }
<a name="l00270"></a>00270   uint8_t <a class="code" href="class_sd_file.html#ab2ec634b54e58a0fffc43071322eceda">timestamp</a>(uint8_t flag, uint16_t year, uint8_t month, uint8_t day,
<a name="l00271"></a>00271           uint8_t hour, uint8_t minute, uint8_t second);
<a name="l00272"></a>00272   uint8_t <a class="code" href="class_sd_file.html#a45144d9d2b4763a514d10b79166b86d2">sync</a>(<span class="keywordtype">void</span>);
<a name="l00278"></a><a class="code" href="class_sd_file.html#a1d1dbbecb58daa5e179ee5efa6b88e87">00278</a>   uint8_t <a class="code" href="class_sd_file.html#a1d1dbbecb58daa5e179ee5efa6b88e87">type</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a>;}
<a name="l00279"></a>00279   uint8_t <a class="code" href="class_sd_file.html#a216a8b58e6c58a33c4c2d84f88ab824f">truncate</a>(uint32_t size);
<a name="l00281"></a><a class="code" href="class_sd_file.html#a62c7b3c788252b26a37bf878ccd13528">00281</a>   uint8_t <a class="code" href="class_sd_file.html#a62c7b3c788252b26a37bf878ccd13528">unbufferedRead</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{
<a name="l00282"></a>00282     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ab9bc8d18308217bd7df78a01eca175b3">flags_</a> &amp; <a class="code" href="class_sd_file.html#a48c45248ecab9849f87cf194dc46f5b3">F_FILE_UNBUFFERED_READ</a>;
<a name="l00283"></a>00283   }
<a name="l00285"></a><a class="code" href="class_sd_file.html#abdc1f41b86a1de2e1aa40da558f18294">00285</a>   <a class="code" href="class_sd_volume.html" title="Access FAT16 and FAT32 volumes on SD and SDHC cards.">SdVolume</a>* <a class="code" href="class_sd_file.html#abdc1f41b86a1de2e1aa40da558f18294">volume</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a63016fa006e3d5ca83b84d58fc49de23">vol_</a>;}
<a name="l00286"></a>00286   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a739c325627945a350e28749b6f2a94a0">write</a>(uint8_t b);
<a name="l00287"></a>00287   int16_t <a class="code" href="class_sd_file.html#a739c325627945a350e28749b6f2a94a0">write</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* buf, uint16_t nbyte);
<a name="l00288"></a>00288   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a739c325627945a350e28749b6f2a94a0">write</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* str);
<a name="l00289"></a>00289   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#af4dace00a7941e0936830200cb3fc9f9">write_P</a>(PGM_P str);
<a name="l00290"></a>00290   <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a01a8e28448c6120f8de1db3f44c15da9">writeln_P</a>(PGM_P str);
<a name="l00291"></a>00291 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00292"></a>00292 <span class="preprocessor">#if ALLOW_DEPRECATED_FUNCTIONS</span>
<a name="l00293"></a>00293 <span class="preprocessor"></span><span class="comment">// Deprecated functions  - suppress cpplint warnings with NOLINT comment</span>
<a name="l00297"></a><a class="code" href="class_sd_file.html#a6f4fba629eeeb95d99effb283d917384">00297</a> <span class="comment"></span>  uint8_t <a class="code" href="class_sd_file.html#a6f4fba629eeeb95d99effb283d917384">contiguousRange</a>(uint32_t&amp; bgnBlock, uint32_t&amp; endBlock) {  <span class="comment">// NOLINT</span>
<a name="l00298"></a>00298     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a58cdd235bc6f1b39342d902a35a2a172">contiguousRange</a>(&amp;bgnBlock, &amp;endBlock);
<a name="l00299"></a>00299   }
<a name="l00304"></a><a class="code" href="class_sd_file.html#a6adea78e2b754e42b94baafc642b73b2">00304</a>   uint8_t <a class="code" href="class_sd_file.html#ab316b89ecd24d3d03781832e094fa9d1">createContiguous</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>&amp; dirFile,  <span class="comment">// NOLINT</span>
<a name="l00305"></a>00305     <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName, uint32_t size) {
<a name="l00306"></a>00306     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ab316b89ecd24d3d03781832e094fa9d1">createContiguous</a>(&amp;dirFile, fileName, size);
<a name="l00307"></a>00307   }
<a name="l00308"></a>00308 
<a name="l00314"></a><a class="code" href="class_sd_file.html#a9342a99088a514724a56e941a9851602">00314</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#ae89cdf7331e346cc8b7ce4a935c5b3e5">dateTimeCallback</a>(
<a name="l00315"></a>00315     <span class="keywordtype">void</span> (*dateTime)(uint16_t&amp; date, uint16_t&amp; time)) {  <span class="comment">// NOLINT</span>
<a name="l00316"></a>00316     <a class="code" href="class_sd_file.html#a065270f4bcd49e3cd298c20d8b30b59a">oldDateTime_</a> = dateTime;
<a name="l00317"></a>00317     <a class="code" href="class_sd_file.html#a0fbdf53a669c68035108f7e71804ebc2">dateTime_</a> = dateTime ? <a class="code" href="class_sd_file.html#a0c24497d7d8d84b02a15703e5d6d787c">oldToNew</a> : 0;
<a name="l00318"></a>00318   }
<a name="l00320"></a><a class="code" href="class_sd_file.html#a147860aabdc3c618b4d5f24700d93129">00320</a>   uint8_t <a class="code" href="class_sd_file.html#a147860aabdc3c618b4d5f24700d93129">dirEntry</a>(<a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>&amp; dir) {<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a147860aabdc3c618b4d5f24700d93129">dirEntry</a>(&amp;dir);}  <span class="comment">// NOLINT</span>
<a name="l00324"></a><a class="code" href="class_sd_file.html#a4b4801fcf40fcf394d4c014cf67cdb87">00324</a> <span class="comment"></span>  uint8_t <a class="code" href="class_sd_file.html#a4b4801fcf40fcf394d4c014cf67cdb87">makeDir</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>&amp; dir, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_sd_file.html#a3d5d6e21ff652084fa88f8f7d902c5b5">dirName</a>) {  <span class="comment">// NOLINT</span>
<a name="l00325"></a>00325     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#ab0d36ef1545b565dd07d006a6a1d81fe">makeDir</a>(&amp;dir, dirName);
<a name="l00326"></a>00326   }
<a name="l00330"></a><a class="code" href="class_sd_file.html#a5160c56eb1f37a27458f99745910c40d">00330</a>   uint8_t <a class="code" href="class_sd_file.html#acf3fbda027da11e3a1ee1ac8505a1a62">open</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>&amp; dirFile, <span class="comment">// NOLINT</span>
<a name="l00331"></a>00331     <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName, uint8_t oflag) {
<a name="l00332"></a>00332     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#acf3fbda027da11e3a1ee1ac8505a1a62">open</a>(&amp;dirFile, fileName, oflag);
<a name="l00333"></a>00333   }
<a name="l00335"></a><a class="code" href="class_sd_file.html#aeaad70fefe05e660b51d8625f41ed791">00335</a>   uint8_t <a class="code" href="class_sd_file.html#aeaad70fefe05e660b51d8625f41ed791">open</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>&amp; dirFile, <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName) {  <span class="comment">// NOLINT</span>
<a name="l00336"></a>00336     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#acf3fbda027da11e3a1ee1ac8505a1a62">open</a>(dirFile, fileName, <a class="code" href="_sd_fat_8h.html#ad79c5a45cb5e4855b771629fc15d78f6">O_RDWR</a>);
<a name="l00337"></a>00337   }
<a name="l00341"></a><a class="code" href="class_sd_file.html#a5b46f4b3b48c99306b497d579db2e663">00341</a>   uint8_t <a class="code" href="class_sd_file.html#a5b46f4b3b48c99306b497d579db2e663">open</a>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>&amp; dirFile, uint16_t index, uint8_t oflag) {  <span class="comment">// NOLINT</span>
<a name="l00342"></a>00342     <span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#acf3fbda027da11e3a1ee1ac8505a1a62">open</a>(&amp;dirFile, index, oflag);
<a name="l00343"></a>00343   }
<a name="l00345"></a><a class="code" href="class_sd_file.html#adb5ec58b2036eec713367b70412aec65">00345</a>   uint8_t <a class="code" href="class_sd_file.html#adb5ec58b2036eec713367b70412aec65">openRoot</a>(<a class="code" href="class_sd_volume.html" title="Access FAT16 and FAT32 volumes on SD and SDHC cards.">SdVolume</a>&amp; vol) {<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#adb5ec58b2036eec713367b70412aec65">openRoot</a>(&amp;vol);}  <span class="comment">// NOLINT</span>
<a name="l00346"></a>00346 
<a name="l00348"></a><a class="code" href="class_sd_file.html#a751e8b0edf4238abdde246d6346653b0">00348</a>   int8_t <a class="code" href="class_sd_file.html#a751e8b0edf4238abdde246d6346653b0">readDir</a>(<a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>&amp; dir) {<span class="keywordflow">return</span> <a class="code" href="class_sd_file.html#a751e8b0edf4238abdde246d6346653b0">readDir</a>(&amp;dir);}  <span class="comment">// NOLINT</span>
<a name="l00352"></a><a class="code" href="class_sd_file.html#a73effbf23113d272b52d334a8cd160b9">00352</a> <span class="comment"></span>  <span class="keyword">static</span> uint8_t <span class="keyword">remove</span>(<a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>&amp; dirFile, <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName) {  <span class="comment">// NOLINT</span>
<a name="l00353"></a>00353     <span class="keywordflow">return</span> <span class="keyword">remove</span>(&amp;dirFile, fileName);
<a name="l00354"></a>00354   }
<a name="l00355"></a>00355 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00356"></a>00356 <span class="comment">// rest are private</span>
<a name="l00357"></a>00357  <span class="keyword">private</span>:
<a name="l00358"></a><a class="code" href="class_sd_file.html#a065270f4bcd49e3cd298c20d8b30b59a">00358</a>   <span class="keyword">static</span> void (*<a class="code" href="class_sd_file.html#a065270f4bcd49e3cd298c20d8b30b59a">oldDateTime_</a>)(uint16_t&amp; date, uint16_t&amp; time);  <span class="comment">// NOLINT</span>
<a name="l00359"></a><a class="code" href="class_sd_file.html#a0c24497d7d8d84b02a15703e5d6d787c">00359</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_file.html#a0c24497d7d8d84b02a15703e5d6d787c">oldToNew</a>(uint16_t* date, uint16_t* time) {
<a name="l00360"></a>00360     uint16_t d;
<a name="l00361"></a>00361     uint16_t t;
<a name="l00362"></a>00362     <a class="code" href="class_sd_file.html#a065270f4bcd49e3cd298c20d8b30b59a">oldDateTime_</a>(d, t);
<a name="l00363"></a>00363     *date = d;
<a name="l00364"></a>00364     *time = t;
<a name="l00365"></a>00365   }
<a name="l00366"></a>00366 <span class="preprocessor">#endif  // ALLOW_DEPRECATED_FUNCTIONS</span>
<a name="l00367"></a>00367 <span class="preprocessor"></span> <span class="keyword">private</span>:
<a name="l00368"></a>00368   <span class="comment">// bits defined in flags_</span>
<a name="l00369"></a>00369   <span class="comment">// should be 0XF</span>
<a name="l00370"></a><a class="code" href="class_sd_file.html#aba9e279d9dcd886c9ed2ceb557fdecef">00370</a>   <span class="keyword">static</span> uint8_t <span class="keyword">const</span> <a class="code" href="class_sd_file.html#aba9e279d9dcd886c9ed2ceb557fdecef">F_OFLAG</a> = (<a class="code" href="_sd_fat_8h.html#a4efda39151f5ef2dc7fbd138be51336a">O_ACCMODE</a> | <a class="code" href="_sd_fat_8h.html#a4242b37e810af3a6485adda0e08a9a2b">O_APPEND</a> | <a class="code" href="_sd_fat_8h.html#a3066c471d52b056dec13fa567f7bbd9d">O_SYNC</a>);
<a name="l00371"></a>00371   <span class="comment">// available bits</span>
<a name="l00372"></a><a class="code" href="class_sd_file.html#a0d70aca70b4268e6391e1419804307f5">00372</a>   <span class="keyword">static</span> uint8_t <span class="keyword">const</span> <a class="code" href="class_sd_file.html#a0d70aca70b4268e6391e1419804307f5">F_UNUSED</a> = 0X30;
<a name="l00373"></a>00373   <span class="comment">// use unbuffered SD read</span>
<a name="l00374"></a><a class="code" href="class_sd_file.html#a48c45248ecab9849f87cf194dc46f5b3">00374</a>   <span class="keyword">static</span> uint8_t <span class="keyword">const</span> <a class="code" href="class_sd_file.html#a48c45248ecab9849f87cf194dc46f5b3">F_FILE_UNBUFFERED_READ</a> = 0X40;
<a name="l00375"></a>00375   <span class="comment">// sync of directory entry required</span>
<a name="l00376"></a><a class="code" href="class_sd_file.html#a6254189769a26f9cb550358dd8b3db26">00376</a>   <span class="keyword">static</span> uint8_t <span class="keyword">const</span> <a class="code" href="class_sd_file.html#a6254189769a26f9cb550358dd8b3db26">F_FILE_DIR_DIRTY</a> = 0X80;
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 <span class="comment">// make sure F_OFLAG is ok</span>
<a name="l00379"></a>00379 <span class="preprocessor">#if ((F_UNUSED | F_FILE_UNBUFFERED_READ | F_FILE_DIR_DIRTY) &amp; F_OFLAG)</span>
<a name="l00380"></a>00380 <span class="preprocessor"></span><span class="preprocessor">#error flags_ bits conflict</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span><span class="preprocessor">#endif  // flags_ bits</span>
<a name="l00382"></a>00382 <span class="preprocessor"></span>
<a name="l00383"></a>00383   <span class="comment">// private data</span>
<a name="l00384"></a><a class="code" href="class_sd_file.html#ab9bc8d18308217bd7df78a01eca175b3">00384</a>   uint8_t   <a class="code" href="class_sd_file.html#ab9bc8d18308217bd7df78a01eca175b3">flags_</a>;         <span class="comment">// See above for definition of flags_ bits</span>
<a name="l00385"></a><a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">00385</a>   uint8_t   <a class="code" href="class_sd_file.html#ac52855672d3aac6d0e3b2228ac9e19dc">type_</a>;          <span class="comment">// type of file see above for values</span>
<a name="l00386"></a><a class="code" href="class_sd_file.html#aff23051fbe8e6ad2efa75c06390047d5">00386</a>   uint32_t  <a class="code" href="class_sd_file.html#aff23051fbe8e6ad2efa75c06390047d5">curCluster_</a>;    <span class="comment">// cluster for current file position</span>
<a name="l00387"></a><a class="code" href="class_sd_file.html#ade9334005143268ed5c81348abbffb4b">00387</a>   uint32_t  <a class="code" href="class_sd_file.html#ade9334005143268ed5c81348abbffb4b">curPosition_</a>;   <span class="comment">// current file position in bytes from beginning</span>
<a name="l00388"></a><a class="code" href="class_sd_file.html#a99b330c30b74c2cf030c279593a4c1dc">00388</a>   uint32_t  <a class="code" href="class_sd_file.html#a99b330c30b74c2cf030c279593a4c1dc">dirBlock_</a>;      <span class="comment">// SD block that contains directory entry for file</span>
<a name="l00389"></a><a class="code" href="class_sd_file.html#adf65af6edbe7a86d1e94c7604c66ea51">00389</a>   uint8_t   <a class="code" href="class_sd_file.html#adf65af6edbe7a86d1e94c7604c66ea51">dirIndex_</a>;      <span class="comment">// index of entry in dirBlock 0 &lt;= dirIndex_ &lt;= 0XF</span>
<a name="l00390"></a><a class="code" href="class_sd_file.html#a95d9791fe91d8b1385fc1f11b1dccb83">00390</a>   uint32_t  <a class="code" href="class_sd_file.html#a95d9791fe91d8b1385fc1f11b1dccb83">fileSize_</a>;      <span class="comment">// file size in bytes</span>
<a name="l00391"></a><a class="code" href="class_sd_file.html#a3ef82733a6bdd87b2f4a3128d2ad510d">00391</a>   uint32_t  <a class="code" href="class_sd_file.html#a3ef82733a6bdd87b2f4a3128d2ad510d">firstCluster_</a>;  <span class="comment">// first cluster of file</span>
<a name="l00392"></a><a class="code" href="class_sd_file.html#a63016fa006e3d5ca83b84d58fc49de23">00392</a>   <a class="code" href="class_sd_volume.html" title="Access FAT16 and FAT32 volumes on SD and SDHC cards.">SdVolume</a>* <a class="code" href="class_sd_file.html#a63016fa006e3d5ca83b84d58fc49de23">vol_</a>;           <span class="comment">// volume where file is located</span>
<a name="l00393"></a>00393 
<a name="l00394"></a>00394   <span class="comment">// private functions</span>
<a name="l00395"></a>00395   uint8_t <a class="code" href="class_sd_file.html#a4bcfdec5cca75866e02f1c19049a31f1">addCluster</a>(<span class="keywordtype">void</span>);
<a name="l00396"></a>00396   uint8_t <a class="code" href="class_sd_file.html#a731608323cbb5f33c2bdd6c51a64bf61">addDirCluster</a>(<span class="keywordtype">void</span>);
<a name="l00397"></a>00397   <a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>* <a class="code" href="class_sd_file.html#aae06fb5c45eef10196905a0227feceef">cacheDirEntry</a>(uint8_t action);
<a name="l00398"></a><a class="code" href="class_sd_file.html#a0fbdf53a669c68035108f7e71804ebc2">00398</a>   <span class="keyword">static</span> void (*<a class="code" href="class_sd_file.html#a0fbdf53a669c68035108f7e71804ebc2">dateTime_</a>)(uint16_t* date, uint16_t* time);
<a name="l00399"></a>00399   <span class="keyword">static</span> uint8_t <a class="code" href="class_sd_file.html#a3c315dcaa00b2e69ac16c2f8fa072562">make83Name</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* str, uint8_t* name);
<a name="l00400"></a>00400   uint8_t <a class="code" href="class_sd_file.html#ae6ae25a70d65c35b20bba78d6d67383c">openCachedEntry</a>(uint8_t cacheIndex, uint8_t oflags);
<a name="l00401"></a>00401   <a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>* <a class="code" href="class_sd_file.html#ab2e6abfaaa82e322e629918cc53665b5">readDirCache</a>(<span class="keywordtype">void</span>);
<a name="l00402"></a>00402 };
<a name="l00403"></a>00403 <span class="comment">//==============================================================================</span>
<a name="l00404"></a>00404 <span class="comment">// SdVolume class</span>
<a name="l00408"></a><a class="code" href="unioncache__t.html">00408</a> <span class="comment"></span><span class="keyword">union </span><a class="code" href="unioncache__t.html" title="Cache for an SD data block.">cache_t</a> {
<a name="l00410"></a><a class="code" href="unioncache__t.html#a3d71d6f767b902517cdc2a90b93d93ef">00410</a>   uint8_t  <a class="code" href="unioncache__t.html#a3d71d6f767b902517cdc2a90b93d93ef">data</a>[512];
<a name="l00412"></a><a class="code" href="unioncache__t.html#afbc2aee9e685ba2ec0b2a3e4cfbaefed">00412</a>   uint16_t <a class="code" href="unioncache__t.html#afbc2aee9e685ba2ec0b2a3e4cfbaefed">fat16</a>[256];
<a name="l00414"></a><a class="code" href="unioncache__t.html#ae7eca49d4c578b2d41d0ca2edfa65a11">00414</a>   uint32_t <a class="code" href="unioncache__t.html#ae7eca49d4c578b2d41d0ca2edfa65a11">fat32</a>[128];
<a name="l00416"></a><a class="code" href="unioncache__t.html#a6d2e24ad404317d817f7691495f9fa5b">00416</a>   <a class="code" href="structdirectory_entry.html" title="FAT short directory entry.">dir_t</a>    <a class="code" href="unioncache__t.html#a6d2e24ad404317d817f7691495f9fa5b">dir</a>[16];
<a name="l00418"></a><a class="code" href="unioncache__t.html#ab085ad5652aa1dcd3d1c289126acb76e">00418</a>   <a class="code" href="structmaster_boot_record.html" title="Master Boot Record.">mbr_t</a>    <a class="code" href="unioncache__t.html#ab085ad5652aa1dcd3d1c289126acb76e">mbr</a>;
<a name="l00420"></a><a class="code" href="unioncache__t.html#aeab1783b510e741a34b3a6ec28e75c89">00420</a>   <a class="code" href="structfat32_boot_sector.html" title="Boot sector for a FAT16 or FAT32 volume.">fbs_t</a>    <a class="code" href="unioncache__t.html#aeab1783b510e741a34b3a6ec28e75c89">fbs</a>;
<a name="l00421"></a>00421 };
<a name="l00422"></a>00422 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00427"></a><a class="code" href="class_sd_volume.html">00427</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="class_sd_volume.html" title="Access FAT16 and FAT32 volumes on SD and SDHC cards.">SdVolume</a> {
<a name="l00428"></a>00428  <span class="keyword">public</span>:
<a name="l00430"></a><a class="code" href="class_sd_volume.html#a6eb8f40694edc652fad3a9b55a39be07">00430</a>   <a class="code" href="class_sd_volume.html#a6eb8f40694edc652fad3a9b55a39be07">SdVolume</a>(<span class="keywordtype">void</span>) :<a class="code" href="class_sd_volume.html#a8971134e76e36a58bc13dd08960f7355">allocSearchStart_</a>(2), <a class="code" href="class_sd_volume.html#a6f0521bb1c1bad2b0ff5109d6a6320e3">fatType_</a>(0) {}
<a name="l00434"></a><a class="code" href="class_sd_volume.html#a1e256c4931cea85d795eb22f093be292">00434</a>   <span class="keyword">static</span> uint8_t* <a class="code" href="class_sd_volume.html#a1e256c4931cea85d795eb22f093be292">cacheClear</a>(<span class="keywordtype">void</span>) {
<a name="l00435"></a>00435     <a class="code" href="class_sd_volume.html#a3f6d01e3cb6eadba4450991f6c0b419b">cacheFlush</a>();
<a name="l00436"></a>00436     <a class="code" href="class_sd_volume.html#aff7820d33e7459503afe447ccd6fb867">cacheBlockNumber_</a> = 0XFFFFFFFF;
<a name="l00437"></a>00437     <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a2cc1a626151e1ae372cab5540c740a9c">cacheBuffer_</a>.<a class="code" href="unioncache__t.html#a3d71d6f767b902517cdc2a90b93d93ef">data</a>;
<a name="l00438"></a>00438   }
<a name="l00450"></a><a class="code" href="class_sd_volume.html#af880c7163feb03d852a9fc5af425b72a">00450</a>   uint8_t <a class="code" href="class_sd_volume.html#af880c7163feb03d852a9fc5af425b72a">init</a>(<a class="code" href="class_sd2_card.html" title="Raw access to SD and SDHC flash memory cards.">Sd2Card</a>* dev) { <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#af880c7163feb03d852a9fc5af425b72a">init</a>(dev, 1) ? <span class="keyword">true</span> : <a class="code" href="class_sd_volume.html#af880c7163feb03d852a9fc5af425b72a">init</a>(dev, 0);}
<a name="l00451"></a>00451   uint8_t <a class="code" href="class_sd_volume.html#af880c7163feb03d852a9fc5af425b72a">init</a>(<a class="code" href="class_sd2_card.html" title="Raw access to SD and SDHC flash memory cards.">Sd2Card</a>* dev, uint8_t part);
<a name="l00452"></a>00452 
<a name="l00453"></a>00453   <span class="comment">// inline functions that return volume info</span>
<a name="l00455"></a><a class="code" href="class_sd_volume.html#aae99995888f6740aa0f582e6dad53d67">00455</a> <span class="comment"></span>  uint8_t <a class="code" href="class_sd_volume.html#aae99995888f6740aa0f582e6dad53d67">blocksPerCluster</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a034c6d16845c12e97738ea5841cd69a9">blocksPerCluster_</a>;}
<a name="l00457"></a><a class="code" href="class_sd_volume.html#a4195fb9f4a04a18312156df9d096abeb">00457</a>   uint32_t <a class="code" href="class_sd_volume.html#a4195fb9f4a04a18312156df9d096abeb">blocksPerFat</a>(<span class="keywordtype">void</span>)<span class="keyword">  const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#af1780962a496439ff8af6946df50c6fd">blocksPerFat_</a>;}
<a name="l00459"></a><a class="code" href="class_sd_volume.html#aec852c108aa5675c063d8ce6bb53ce1e">00459</a>   uint32_t <a class="code" href="class_sd_volume.html#aec852c108aa5675c063d8ce6bb53ce1e">clusterCount</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a903dab7955c7199a1b8dcbab453627de">clusterCount_</a>;}
<a name="l00461"></a><a class="code" href="class_sd_volume.html#acb62ed89ba7ede69de709370318221fc">00461</a>   uint8_t <a class="code" href="class_sd_volume.html#acb62ed89ba7ede69de709370318221fc">clusterSizeShift</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a1756eeefb2456c7a5fe12139ca5e16ff">clusterSizeShift_</a>;}
<a name="l00463"></a><a class="code" href="class_sd_volume.html#a47f0a4a305fbd010441ec7f8d1e1e725">00463</a>   uint32_t <a class="code" href="class_sd_volume.html#a47f0a4a305fbd010441ec7f8d1e1e725">dataStartBlock</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a82c9b8371cb024e277704da07f3b21cf">dataStartBlock_</a>;}
<a name="l00465"></a><a class="code" href="class_sd_volume.html#a37b16eddf77fdf54da9f7f0ff0c78cad">00465</a>   uint8_t <a class="code" href="class_sd_volume.html#a37b16eddf77fdf54da9f7f0ff0c78cad">fatCount</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#ade92bd3ab96c8a11ae6e20139ed7bb8b">fatCount_</a>;}
<a name="l00467"></a><a class="code" href="class_sd_volume.html#ab17a497cc70a17025df17ba12c65e3ba">00467</a>   uint32_t <a class="code" href="class_sd_volume.html#ab17a497cc70a17025df17ba12c65e3ba">fatStartBlock</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a1eb3811c3747ab9c7cdecc5e19603522">fatStartBlock_</a>;}
<a name="l00469"></a><a class="code" href="class_sd_volume.html#a6ff5cd2fbfd3599c9f7ab2a2956f4755">00469</a>   uint8_t <a class="code" href="class_sd_volume.html#a6ff5cd2fbfd3599c9f7ab2a2956f4755">fatType</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a6f0521bb1c1bad2b0ff5109d6a6320e3">fatType_</a>;}
<a name="l00471"></a><a class="code" href="class_sd_volume.html#ae3bf8aef3b5959c0581be1b6e272b12c">00471</a>   uint32_t <a class="code" href="class_sd_volume.html#ae3bf8aef3b5959c0581be1b6e272b12c">rootDirEntryCount</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a557d01e917256bf2664edbe547b2c6f8">rootDirEntryCount_</a>;}
<a name="l00474"></a><a class="code" href="class_sd_volume.html#ae1b9707103c483f331d612d4c99c568e">00474</a>   uint32_t <a class="code" href="class_sd_volume.html#ae1b9707103c483f331d612d4c99c568e">rootDirStart</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a6c73bc9622358cc717df0290dcfc226c">rootDirStart_</a>;}
<a name="l00476"></a><a class="code" href="class_sd_volume.html#abb035edfb3ed8836be317572aa6e3715">00476</a>   <span class="keyword">static</span> <a class="code" href="class_sd2_card.html" title="Raw access to SD and SDHC flash memory cards.">Sd2Card</a>* <a class="code" href="class_sd_volume.html#abb035edfb3ed8836be317572aa6e3715">sdCard</a>(<span class="keywordtype">void</span>) {<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a4af785acfbe605270a1270eabd99eec0">sdCard_</a>;}
<a name="l00477"></a>00477 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00478"></a>00478 <span class="preprocessor">#if ALLOW_DEPRECATED_FUNCTIONS</span>
<a name="l00479"></a>00479 <span class="preprocessor"></span>  <span class="comment">// Deprecated functions  - suppress cpplint warnings with NOLINT comment</span>
<a name="l00481"></a><a class="code" href="class_sd_volume.html#a855aefd0571bee73b36976fe2336ebd8">00481</a> <span class="comment"></span>  uint8_t <a class="code" href="class_sd_volume.html#a855aefd0571bee73b36976fe2336ebd8">init</a>(<a class="code" href="class_sd2_card.html" title="Raw access to SD and SDHC flash memory cards.">Sd2Card</a>&amp; dev) {<span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a855aefd0571bee73b36976fe2336ebd8">init</a>(&amp;dev);}  <span class="comment">// NOLINT</span>
<a name="l00482"></a>00482 
<a name="l00484"></a><a class="code" href="class_sd_volume.html#a3be911c47b87e9f38a5c1efeaf8f5614">00484</a>   uint8_t <a class="code" href="class_sd_volume.html#a3be911c47b87e9f38a5c1efeaf8f5614">init</a>(<a class="code" href="class_sd2_card.html" title="Raw access to SD and SDHC flash memory cards.">Sd2Card</a>&amp; dev, uint8_t part) {  <span class="comment">// NOLINT</span>
<a name="l00485"></a>00485     <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#af880c7163feb03d852a9fc5af425b72a">init</a>(&amp;dev, part);
<a name="l00486"></a>00486   }
<a name="l00487"></a>00487 <span class="preprocessor">#endif  // ALLOW_DEPRECATED_FUNCTIONS</span>
<a name="l00488"></a>00488 <span class="preprocessor"></span><span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00489"></a>00489   <span class="keyword">private</span>:
<a name="l00490"></a>00490   <span class="comment">// Allow SdFile access to SdVolume private data.</span>
<a name="l00491"></a><a class="code" href="class_sd_volume.html#ad89809cf54bdf885b0505e5edeff2049">00491</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="class_sd_file.html" title="Access FAT16 and FAT32 files on SD and SDHC cards.">SdFile</a>;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493   <span class="comment">// value for action argument in cacheRawBlock to indicate read from cache</span>
<a name="l00494"></a><a class="code" href="class_sd_volume.html#a5330b5c50bf685a94db992c5cbbbc1d9">00494</a>   <span class="keyword">static</span> uint8_t <span class="keyword">const</span> <a class="code" href="class_sd_volume.html#a5330b5c50bf685a94db992c5cbbbc1d9">CACHE_FOR_READ</a> = 0;
<a name="l00495"></a>00495   <span class="comment">// value for action argument in cacheRawBlock to indicate cache dirty</span>
<a name="l00496"></a><a class="code" href="class_sd_volume.html#ae65a3251694e51e0f38f1b813f234998">00496</a>   <span class="keyword">static</span> uint8_t <span class="keyword">const</span> <a class="code" href="class_sd_volume.html#ae65a3251694e51e0f38f1b813f234998">CACHE_FOR_WRITE</a> = 1;
<a name="l00497"></a>00497 
<a name="l00498"></a><a class="code" href="class_sd_volume.html#a2cc1a626151e1ae372cab5540c740a9c">00498</a>   <span class="keyword">static</span> <a class="code" href="unioncache__t.html" title="Cache for an SD data block.">cache_t</a> <a class="code" href="class_sd_volume.html#a2cc1a626151e1ae372cab5540c740a9c">cacheBuffer_</a>;        <span class="comment">// 512 byte cache for device blocks</span>
<a name="l00499"></a><a class="code" href="class_sd_volume.html#aff7820d33e7459503afe447ccd6fb867">00499</a>   <span class="keyword">static</span> uint32_t <a class="code" href="class_sd_volume.html#aff7820d33e7459503afe447ccd6fb867">cacheBlockNumber_</a>;  <span class="comment">// Logical number of block in the cache</span>
<a name="l00500"></a><a class="code" href="class_sd_volume.html#a4af785acfbe605270a1270eabd99eec0">00500</a>   <span class="keyword">static</span> <a class="code" href="class_sd2_card.html" title="Raw access to SD and SDHC flash memory cards.">Sd2Card</a>* <a class="code" href="class_sd_volume.html#a4af785acfbe605270a1270eabd99eec0">sdCard_</a>;            <span class="comment">// Sd2Card object for cache</span>
<a name="l00501"></a><a class="code" href="class_sd_volume.html#afdc1bfde442c310bf8f964107f487543">00501</a>   <span class="keyword">static</span> uint8_t <a class="code" href="class_sd_volume.html#afdc1bfde442c310bf8f964107f487543">cacheDirty_</a>;         <span class="comment">// cacheFlush() will write block if true</span>
<a name="l00502"></a><a class="code" href="class_sd_volume.html#a1ef6877e2e738b66d5ffebddcc8d59f3">00502</a>   <span class="keyword">static</span> uint32_t <a class="code" href="class_sd_volume.html#a1ef6877e2e738b66d5ffebddcc8d59f3">cacheMirrorBlock_</a>;  <span class="comment">// block number for mirror FAT</span>
<a name="l00503"></a>00503 <span class="comment">//</span>
<a name="l00504"></a><a class="code" href="class_sd_volume.html#a8971134e76e36a58bc13dd08960f7355">00504</a>   uint32_t <a class="code" href="class_sd_volume.html#a8971134e76e36a58bc13dd08960f7355">allocSearchStart_</a>;   <span class="comment">// start cluster for alloc search</span>
<a name="l00505"></a><a class="code" href="class_sd_volume.html#a034c6d16845c12e97738ea5841cd69a9">00505</a>   uint8_t <a class="code" href="class_sd_volume.html#a034c6d16845c12e97738ea5841cd69a9">blocksPerCluster_</a>;    <span class="comment">// cluster size in blocks</span>
<a name="l00506"></a><a class="code" href="class_sd_volume.html#af1780962a496439ff8af6946df50c6fd">00506</a>   uint32_t <a class="code" href="class_sd_volume.html#af1780962a496439ff8af6946df50c6fd">blocksPerFat_</a>;       <span class="comment">// FAT size in blocks</span>
<a name="l00507"></a><a class="code" href="class_sd_volume.html#a903dab7955c7199a1b8dcbab453627de">00507</a>   uint32_t <a class="code" href="class_sd_volume.html#a903dab7955c7199a1b8dcbab453627de">clusterCount_</a>;       <span class="comment">// clusters in one FAT</span>
<a name="l00508"></a><a class="code" href="class_sd_volume.html#a1756eeefb2456c7a5fe12139ca5e16ff">00508</a>   uint8_t <a class="code" href="class_sd_volume.html#a1756eeefb2456c7a5fe12139ca5e16ff">clusterSizeShift_</a>;    <span class="comment">// shift to convert cluster count to block count</span>
<a name="l00509"></a><a class="code" href="class_sd_volume.html#a82c9b8371cb024e277704da07f3b21cf">00509</a>   uint32_t <a class="code" href="class_sd_volume.html#a82c9b8371cb024e277704da07f3b21cf">dataStartBlock_</a>;     <span class="comment">// first data block number</span>
<a name="l00510"></a><a class="code" href="class_sd_volume.html#ade92bd3ab96c8a11ae6e20139ed7bb8b">00510</a>   uint8_t <a class="code" href="class_sd_volume.html#ade92bd3ab96c8a11ae6e20139ed7bb8b">fatCount_</a>;            <span class="comment">// number of FATs on volume</span>
<a name="l00511"></a><a class="code" href="class_sd_volume.html#a1eb3811c3747ab9c7cdecc5e19603522">00511</a>   uint32_t <a class="code" href="class_sd_volume.html#a1eb3811c3747ab9c7cdecc5e19603522">fatStartBlock_</a>;      <span class="comment">// start block for first FAT</span>
<a name="l00512"></a><a class="code" href="class_sd_volume.html#a6f0521bb1c1bad2b0ff5109d6a6320e3">00512</a>   uint8_t <a class="code" href="class_sd_volume.html#a6f0521bb1c1bad2b0ff5109d6a6320e3">fatType_</a>;             <span class="comment">// volume type (12, 16, OR 32)</span>
<a name="l00513"></a><a class="code" href="class_sd_volume.html#a557d01e917256bf2664edbe547b2c6f8">00513</a>   uint16_t <a class="code" href="class_sd_volume.html#a557d01e917256bf2664edbe547b2c6f8">rootDirEntryCount_</a>;  <span class="comment">// number of entries in FAT16 root dir</span>
<a name="l00514"></a><a class="code" href="class_sd_volume.html#a6c73bc9622358cc717df0290dcfc226c">00514</a>   uint32_t <a class="code" href="class_sd_volume.html#a6c73bc9622358cc717df0290dcfc226c">rootDirStart_</a>;       <span class="comment">// root start block for FAT16, cluster for FAT32</span>
<a name="l00515"></a>00515   <span class="comment">//----------------------------------------------------------------------------</span>
<a name="l00516"></a>00516   uint8_t <a class="code" href="class_sd_volume.html#ac9177b12fdbea8c21b5d24bffb854ae9">allocContiguous</a>(uint32_t count, uint32_t* <a class="code" href="class_sd_file.html#ab287e557593ad32f46b92ec5b11c5e0f">curCluster</a>);
<a name="l00517"></a><a class="code" href="class_sd_volume.html#a40416a35beda5b5b7ebf000d274d80e5">00517</a>   uint8_t <a class="code" href="class_sd_volume.html#a40416a35beda5b5b7ebf000d274d80e5">blockOfCluster</a>(uint32_t position)<span class="keyword"> const </span>{
<a name="l00518"></a>00518           <span class="keywordflow">return</span> (position &gt;&gt; 9) &amp; (<a class="code" href="class_sd_volume.html#a034c6d16845c12e97738ea5841cd69a9">blocksPerCluster_</a> - 1);}
<a name="l00519"></a><a class="code" href="class_sd_volume.html#a1a7376b8098a3b1f5d6a125e4f985d58">00519</a>   uint32_t <a class="code" href="class_sd_volume.html#a1a7376b8098a3b1f5d6a125e4f985d58">clusterStartBlock</a>(uint32_t cluster)<span class="keyword"> const </span>{
<a name="l00520"></a>00520            <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a82c9b8371cb024e277704da07f3b21cf">dataStartBlock_</a> + ((cluster - 2) &lt;&lt; <a class="code" href="class_sd_volume.html#a1756eeefb2456c7a5fe12139ca5e16ff">clusterSizeShift_</a>);}
<a name="l00521"></a><a class="code" href="class_sd_volume.html#a0899b311144acdc6c515aacd9fc29241">00521</a>   uint32_t <a class="code" href="class_sd_volume.html#a0899b311144acdc6c515aacd9fc29241">blockNumber</a>(uint32_t cluster, uint32_t position)<span class="keyword"> const </span>{
<a name="l00522"></a>00522            <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a1a7376b8098a3b1f5d6a125e4f985d58">clusterStartBlock</a>(cluster) + <a class="code" href="class_sd_volume.html#a40416a35beda5b5b7ebf000d274d80e5">blockOfCluster</a>(position);}
<a name="l00523"></a>00523   <span class="keyword">static</span> uint8_t <a class="code" href="class_sd_volume.html#a3f6d01e3cb6eadba4450991f6c0b419b">cacheFlush</a>(<span class="keywordtype">void</span>);
<a name="l00524"></a>00524   <span class="keyword">static</span> uint8_t <a class="code" href="class_sd_volume.html#a7647ddfc4375e9bc3f3b1ce03ff26d15">cacheRawBlock</a>(uint32_t <a class="code" href="class_sd_volume.html#a0899b311144acdc6c515aacd9fc29241">blockNumber</a>, uint8_t action);
<a name="l00525"></a><a class="code" href="class_sd_volume.html#ad98c9c62eee6d8fffc1197e853b22b8e">00525</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_sd_volume.html#ad98c9c62eee6d8fffc1197e853b22b8e">cacheSetDirty</a>(<span class="keywordtype">void</span>) {<a class="code" href="class_sd_volume.html#afdc1bfde442c310bf8f964107f487543">cacheDirty_</a> |= <a class="code" href="class_sd_volume.html#ae65a3251694e51e0f38f1b813f234998">CACHE_FOR_WRITE</a>;}
<a name="l00526"></a>00526   <span class="keyword">static</span> uint8_t <a class="code" href="class_sd_volume.html#ac37020868dea2224bad13d29d12c5c86">cacheZeroBlock</a>(uint32_t <a class="code" href="class_sd_volume.html#a0899b311144acdc6c515aacd9fc29241">blockNumber</a>);
<a name="l00527"></a>00527   uint8_t <a class="code" href="class_sd_volume.html#ae039f58f4b132f038906ffb7656d51dc">chainSize</a>(uint32_t beginCluster, uint32_t* size) <span class="keyword">const</span>;
<a name="l00528"></a>00528   uint8_t <a class="code" href="class_sd_volume.html#ae43d8db6904a653488b12ecc62c9de20">fatGet</a>(uint32_t cluster, uint32_t* value) <span class="keyword">const</span>;
<a name="l00529"></a>00529   uint8_t <a class="code" href="class_sd_volume.html#a638f424f4c084770bb3af788424e7807">fatPut</a>(uint32_t cluster, uint32_t value);
<a name="l00530"></a><a class="code" href="class_sd_volume.html#aec08655584bfffec809020aa3d0df542">00530</a>   uint8_t <a class="code" href="class_sd_volume.html#aec08655584bfffec809020aa3d0df542">fatPutEOC</a>(uint32_t cluster) {
<a name="l00531"></a>00531     <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a638f424f4c084770bb3af788424e7807">fatPut</a>(cluster, 0x0FFFFFFF);
<a name="l00532"></a>00532   }
<a name="l00533"></a>00533   uint8_t <a class="code" href="class_sd_volume.html#a8e43a92a4f80a8ac73e90857465fa067">freeChain</a>(uint32_t cluster);
<a name="l00534"></a><a class="code" href="class_sd_volume.html#a8d57785ba003824320fd4275da542785">00534</a>   uint8_t <a class="code" href="class_sd_volume.html#a8d57785ba003824320fd4275da542785">isEOC</a>(uint32_t cluster)<span class="keyword"> const </span>{
<a name="l00535"></a>00535     <span class="keywordflow">return</span>  cluster &gt;= (<a class="code" href="class_sd_volume.html#a6f0521bb1c1bad2b0ff5109d6a6320e3">fatType_</a> == 16 ? <a class="code" href="_fat_structs_8h.html#a79b2cefbcfdbf3507fe0496804541b0d">FAT16EOC_MIN</a> : <a class="code" href="_fat_structs_8h.html#af5bcc97de8cc4956435d06349d6e714b">FAT32EOC_MIN</a>);
<a name="l00536"></a>00536   }
<a name="l00537"></a><a class="code" href="class_sd_volume.html#a6d295608df4a0128284a1e2d6e68edbc">00537</a>   uint8_t <a class="code" href="class_sd_volume.html#a6d295608df4a0128284a1e2d6e68edbc">readBlock</a>(uint32_t block, uint8_t* dst) {
<a name="l00538"></a>00538     <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a4af785acfbe605270a1270eabd99eec0">sdCard_</a>-&gt;<a class="code" href="class_sd2_card.html#a6d295608df4a0128284a1e2d6e68edbc">readBlock</a>(block, dst);}
<a name="l00539"></a><a class="code" href="class_sd_volume.html#a525482be6c5fb2e2725db1e7e42fc9f0">00539</a>   uint8_t <a class="code" href="class_sd_volume.html#a525482be6c5fb2e2725db1e7e42fc9f0">readData</a>(uint32_t block, uint16_t offset,
<a name="l00540"></a>00540     uint16_t count, uint8_t* dst) {
<a name="l00541"></a>00541       <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a4af785acfbe605270a1270eabd99eec0">sdCard_</a>-&gt;<a class="code" href="class_sd2_card.html#a525482be6c5fb2e2725db1e7e42fc9f0">readData</a>(block, offset, count, dst);
<a name="l00542"></a>00542   }
<a name="l00543"></a><a class="code" href="class_sd_volume.html#a086596ad7924c98f40e5000b607a6684">00543</a>   uint8_t <a class="code" href="class_sd_volume.html#a086596ad7924c98f40e5000b607a6684">writeBlock</a>(uint32_t block, <span class="keyword">const</span> uint8_t* dst) {
<a name="l00544"></a>00544     <span class="keywordflow">return</span> <a class="code" href="class_sd_volume.html#a4af785acfbe605270a1270eabd99eec0">sdCard_</a>-&gt;<a class="code" href="class_sd2_card.html#a8916d7a9cb65fc347f5a8195990d037f">writeBlock</a>(block, dst);
<a name="l00545"></a>00545   }
<a name="l00546"></a>00546 };
<a name="l00547"></a>00547 <span class="preprocessor">#endif  // SdFat_h</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_sd_fat_8h.html">SdFat.h</a>      </li>
      <li class="footer">Generated on Sun Oct 9 2011 17:34:11 for Repetier-Firmware by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
